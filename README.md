# Модель детекции штрихкодов

## Цель проекта
С помощью алгоритмов детекции правильно локализовать штрихкод

## Данные
Датасет, собранный на Толоке в формате tsv, где есть информация о позиции штрихкода

Для тренировки и валидации данные разбиты в таком формате:

|  train | val    
| ------ | -------
|  337   |   144    


## Запуск репозитория

В корне репозитория лежит Makefile, в котором есть необходимые для запуска команды:

`make setup` - создаёт виртуальное окружение, загружает зависимости и скачивает данные через dvc

`make train` - запускает обучение с файлом конфигурации из *configs/base_config.yaml*, его можно изменить или определить другой в Makefile

`make export` - экспортирует модель в ONNX для дальнейшего инференса. Чтобы указать путь до модели надо переопределить переменную в Makefile или при запуске указать `EXPORT_MODEL_PATH=путь_до_весов`


## Результаты
При запуске самой маленькой YOLOv8 со стандартными настройками удалось выбить 0.994 mAP@50 [CLEARML](https://app.clear.ml/projects/5d5a9d847db4481d8672564035febae6/experiments/1b4eeb370c2647a1bf8151d8835eaad8/output/execution), эта модель выгружена в ONNX для дальнейшего инференса и особых экспериментов кроме изменения размеров изображения не производилось

![plot](pictures/PR_curve.png)
![plot](pictures/F1_curve.png)
![plot](pictures/results.png)

Графики показывают очень хорошие результаты модели

![plot](pictures/val_batch1_pred.jpg) 
![plot](pictures/val_batch2_pred.jpg)

На изображениях можно заметить FP срабатывания, но они имеют невысокую уверенность, поэтому их можно будет убрать по порогу
